import sys

# Command: python sol_3.1.2.4.py 3.1.2.4_RSA_ciphertext.hex 3.1.2.4_RSA_private_key.hex 3.1.2.4_RSA_modulo.hex sol_3.1.2.4.hex

if len(sys.argv) < 5:
    print("Missing arguments: python your_script.py ciphertext_file key_file modulo_file output_file")

with open(sys.argv[1]) as cipher, open(sys.argv[2]) as key, open(sys.argv[3]) as modulo, open(sys.argv[4], 'w') as out:
	cipher_content = int(cipher.read().strip(), 16)
	key_content = int(key.read().strip(), 16)
	modulo_content = int(modulo.read().strip(), 16)

	out.write(str(hex(pow(cipher_content, key_content, modulo_content))[2:-1]))
	# decrypted = hex(pow(cipher_content, key_content, modulo_content))
	# print(cipher_content) # 82403222525452126397543514073306991775918690256256261472903128074069697868655949072909991909702349705097522665038017996762748441969510097083364178716652004709014441673144593968155175199807935169162298164368466127631992457404446502797673141423566010838760114877837019747324801835755346219481128846329355351061
	# print(key_content) # 691
	# print(modulo_content) # 141324300856747927511283422207763937246947128930114908946772531095127854298472634115423496315687231357959119270298365894012872925602025436513949145351811057616516539218311321243743058895527331642197884250683808871372942010499748977225776608525179144341392236384138978208169468106829930365596235481559468779449
	# print(decrypted)
